import { join } from 'path';
import { ConventionalGitClient } from '@conventional-changelog/git-client';
import { Bumper } from 'conventional-recommended-bump';
import { ConventionalChangelog } from 'conventional-changelog';
import { concatStringStream } from '@simple-libs/stream-utils';
import { parseHostedGitUrl } from '@simple-libs/hosted-git-info';
import semver, {} from 'semver';
import { addReleaseNotes, extractLastRelease, extractLastReleaseFromFile } from '../change-log.js';
import { getReleaseType } from '../utils.js';
export * from './project.types.js';
export const bumpDefaultOptions = {
    preset: {
        name: 'conventionalcommits',
        bumpStrict: true
    }
};
/**
 * A base class that represents a project.
 */
export class Project {
    /**
     * The manifest of the project.
     */
    manifest;
    /**
     * The git client used to interact with the repository.
     */
    gitClient;
    options;
    /**
     * Changed files after interacting with the project.
     */
    changedFiles = [];
    /**
     * Version updates after interacting with the project.
     */
    versionUpdates = [];
    /**
     * Creates a new instance of the project.
     * @param options - The options to use for the project.
     */
    constructor(options) {
        const { manifest, compose, gitClient = new ConventionalGitClient(manifest.projectPath) } = options;
        this.options = {
            changelogFile: 'CHANGELOG.md',
            ...options
        };
        this.manifest = compose ? compose(manifest) : manifest;
        this.gitClient = gitClient;
    }
    /**
     * Get the hosted git information for the project.
     * @returns The hosted git information.
     */
    async getHostedGitInfo() {
        const remote = await this.gitClient.getConfig('remote.origin.url');
        const info = parseHostedGitUrl(remote);
        return info;
    }
    /**
     * Get the commit message for the version updates.
     * @returns The commit message.
     */
    getCommitMessage() {
        const { versionUpdates } = this;
        if (versionUpdates.length === 0) {
            throw new Error('Nothing to commit');
        }
        return `chore(release): ${versionUpdates[0].to}`;
    }
    /**
     * Get new git tags for the version updates.
     * @param options - The options to use for getting the tags.
     * @returns The new git tags.
     */
    async getTags(options = {}) {
        const { manifest, gitClient } = this;
        const { tagPrefix = 'v', verify = true } = options;
        const version = await manifest.getVersion();
        const tag = `${tagPrefix}${version}`;
        if (verify) {
            const isTagExists = await gitClient.verify(tag, true);
            if (isTagExists) {
                return [];
            }
        }
        return [tag];
    }
    /**
     * Get the release data for the project.
     * @param options - The options to use for getting the release data.
     * @returns The release data.
     */
    async getReleaseData(options = {}) {
        const { manifest, versionUpdates } = this;
        const { changelogFile } = this.options;
        const { projectPath } = manifest;
        const changelogPath = join(projectPath, changelogFile);
        const version = await manifest.getVersion();
        const isPrerelease = Boolean(await manifest.getPrereleaseVersion());
        const lastRelease = versionUpdates.length
            ? await extractLastRelease(versionUpdates[0].notes)
            : await extractLastReleaseFromFile(changelogPath);
        if (!lastRelease || lastRelease.version && lastRelease.version !== version) {
            return [];
        }
        if (!lastRelease.nextTag) {
            const tags = await this.getTags({
                ...options,
                verify: false
            });
            if (tags.length) {
                [lastRelease.nextTag] = tags;
            }
        }
        return [
            {
                ...lastRelease,
                title: `v${version}`,
                version,
                isPrerelease
            }
        ];
    }
    /**
     * Get the next version for the project.
     * @param options - The options to use for getting the next version.
     * @returns The next version.
     */
    async getNextVersion(options = {}) {
        const { gitClient, manifest } = this;
        if (options.skip || !options.forcePrivate && await manifest.isPrivate()) {
            return null;
        }
        const { projectPath } = manifest;
        const { version: forcedVersion, baseVersion, as, prerelease, firstRelease: firstReleaseOption, tagPrefix, preset = bumpDefaultOptions.preset } = options;
        let firstRelease = firstReleaseOption;
        if (forcedVersion && semver.valid(forcedVersion)) {
            return forcedVersion;
        }
        if (typeof firstRelease === 'undefined') {
            firstRelease = !await gitClient.getLastTag({
                path: projectPath
            });
        }
        const version = baseVersion || await manifest.getVersion();
        if (firstRelease) {
            return version;
        }
        let releaseType = null;
        if (as) {
            releaseType = as;
        }
        else {
            const bump = await new Bumper(gitClient)
                .loadPreset(preset, _ => import(_))
                .commits({
                path: projectPath
            })
                .tag({
                prefix: tagPrefix
            })
                .bump();
            if ('releaseType' in bump) {
                releaseType = bump.releaseType;
            }
        }
        if (!releaseType) {
            return null;
        }
        const nextVersion = semver.inc(version, getReleaseType(releaseType, version, prerelease), prerelease);
        return nextVersion;
    }
    /**
     * Bump the version of the project.
     * @param options - The options to use for bumping the version.
     * @returns Whether the version was bumped.
     */
    async bump(options = {}) {
        const nextVersion = await this.getNextVersion(options);
        if (!nextVersion) {
            return false;
        }
        const { gitClient, manifest } = this;
        const { changelogFile } = this.options;
        const { tagPrefix, preset = bumpDefaultOptions.preset, dryRun, logger } = options;
        const { projectPath } = manifest;
        const version = await manifest.getVersion();
        const versionUpdate = {
            ...await manifest.writeVersion(nextVersion, dryRun),
            notes: ''
        };
        this.changedFiles.push(...versionUpdate.files);
        const changelogPath = join(projectPath, changelogFile);
        const name = await manifest.getName();
        if (version === nextVersion) {
            logger?.verbose(`${name}: ${nextVersion}`);
        }
        else {
            logger?.verbose(`${name}: ${version} -> ${nextVersion}`);
        }
        const notes = new ConventionalChangelog(gitClient)
            .loadPreset(preset, _ => import(_))
            .commits({
            path: projectPath
        })
            .tags({
            prefix: tagPrefix
        })
            .readRepository()
            .context({
            version: nextVersion
        })
            .write();
        versionUpdate.notes = dryRun
            ? await concatStringStream(notes)
            : await addReleaseNotes(changelogPath, notes);
        logger?.verbose(`Release notes:\n\n${versionUpdate.notes}`);
        this.changedFiles.push(changelogPath);
        this.versionUpdates.push(versionUpdate);
        return true;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvamVjdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wcm9qZWN0L3Byb2plY3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLE1BQU0sQ0FBQTtBQUMzQixPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSxvQ0FBb0MsQ0FBQTtBQUMxRSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sK0JBQStCLENBQUE7QUFDdEQsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sd0JBQXdCLENBQUE7QUFDOUQsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sMkJBQTJCLENBQUE7QUFDOUQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sOEJBQThCLENBQUE7QUFDaEUsT0FBTyxNQUFNLEVBQUUsRUFBb0IsTUFBTSxRQUFRLENBQUE7QUFFakQsT0FBTyxFQUNMLGVBQWUsRUFDZixrQkFBa0IsRUFDbEIsMEJBQTBCLEVBQzNCLE1BQU0sa0JBQWtCLENBQUE7QUFFekIsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGFBQWEsQ0FBQTtBQVU1QyxjQUFjLG9CQUFvQixDQUFBO0FBRWxDLE1BQU0sQ0FBQyxNQUFNLGtCQUFrQixHQUFHO0lBQ2hDLE1BQU0sRUFBRTtRQUNOLElBQUksRUFBRSxxQkFBcUI7UUFDM0IsVUFBVSxFQUFFLElBQUk7S0FDakI7Q0FDRixDQUFBO0FBRUQ7O0dBRUc7QUFDSCxNQUFNLE9BQWdCLE9BQU87SUFDM0I7O09BRUc7SUFDSCxRQUFRLENBQWlCO0lBQ3pCOztPQUVHO0lBQ0gsU0FBUyxDQUF1QjtJQUNoQyxPQUFPLENBQWdCO0lBQ3ZCOztPQUVHO0lBQ0gsWUFBWSxHQUFhLEVBQUUsQ0FBQTtJQUMzQjs7T0FFRztJQUNILGNBQWMsR0FBMkIsRUFBRSxDQUFBO0lBRTNDOzs7T0FHRztJQUNILFlBQVksT0FBdUI7UUFDakMsTUFBTSxFQUNKLFFBQVEsRUFDUixPQUFP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