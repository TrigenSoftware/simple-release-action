/* eslint-disable @typescript-eslint/no-explicit-any */
import { findUp } from 'find-up-simple';
const VARIANTS = [
    '.simple-release.js',
    '.simple-release.mjs',
    '.simple-release.cjs'
];
function validate(target, rules) {
    for (const [rule, required] of Object.entries(rules)) {
        if (required && target[rule] === undefined) {
            throw new Error(`Faild to load config: '${rule}' is required`);
        }
    }
}
export async function load(requirements = {}) {
    const { config: configRequired, ...reqs } = requirements;
    for (const variant of VARIANTS) {
        const foundPath = await findUp(variant);
        if (foundPath) {
            try {
                const module = await import(foundPath);
                const config = 'default' in module ? module.default : module;
                validate(config, reqs);
                return config;
            }
            catch (err) {
                if (configRequired) {
                    throw err;
                }
                return null;
            }
        }
    }
    if (configRequired) {
        throw new Error('Config not found');
    }
    return null;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsdURBQXVEO0FBQ3ZELE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQTtBQVF2QyxNQUFNLFFBQVEsR0FBRztJQUNmLG9CQUFvQjtJQUNwQixxQkFBcUI7SUFDckIscUJBQXFCO0NBQ3RCLENBQUE7QUFtQ0QsU0FBUyxRQUFRLENBQUMsTUFBMkIsRUFBRSxLQUEwQjtJQUN2RSxLQUFLLE1BQU0sQ0FBQyxJQUFJLEVBQUUsUUFBUSxDQUFDLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRTtRQUNwRCxJQUFJLFFBQVEsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssU0FBUyxFQUFFO1lBQzFDLE1BQU0sSUFBSSxLQUFLLENBQUMsMEJBQTBCLElBQUksZUFBZSxDQUFDLENBQUE7U0FDL0Q7S0FDRjtBQUNILENBQUM7QUFhRCxNQUFNLENBQUMsS0FBSyxVQUFVLElBQUksQ0FBQyxlQUFvQyxFQUFFO0lBQy9ELE1BQU0sRUFDSixNQUFNLEVBQUUsY0FBYyxFQUN0QixHQUFHLElBQUksRUFDUixHQUFHLFlBQVksQ0FBQTtJQUVoQixLQUFLLE1BQU0sT0FBTyxJQUFJLFFBQVEsRUFBRTtRQUM5QixNQUFNLFNBQVMsR0FBRyxNQUFNLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUV2QyxJQUFJLFNBQVMsRUFBRTtZQUNiLElBQUk7Z0JBQ0YsTUFBTSxNQUFNLEdBQUcsTUFBTSxNQUFNLENBQUMsU0FBUyxDQUEyRCxDQUFBO2dCQUNoRyxNQUFNLE1BQU0sR0FBRyxTQUFTLElBQUksTUFBTSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUE7Z0JBRTVELFFBQVEsQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUE7Z0JBRXRCLE9BQU8sTUFBTSxDQUFBO2FBQ2Q7WUFBQyxPQUFPLEdBQUcsRUFBRTtnQkFDWixJQUFJLGNBQWMsRUFBRTtvQkFDbEIsTUFBTSxHQUFHLENBQUE7aUJBQ1Y7Z0JBRUQsT0FBTyxJQUFJLENBQUE7YUFDWjtTQUNGO0tBQ0Y7SUFFRCxJQUFJLGNBQWMsRUFBRTtRQUNsQixNQUFNLElBQUksS0FBSyxDQUFDLGtCQUFrQixDQUFDLENBQUE7S0FDcEM7SUFFRCxPQUFPLElBQUksQ0FBQTtBQUNiLENBQUMifQ==